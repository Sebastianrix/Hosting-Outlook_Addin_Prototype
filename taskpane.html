<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <!-- p5.js library -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
    <!-- jsPDF library -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

</head>

<body>
    <p>This add-in will insert your text as a image!</p>
    <button id="NoDiT_Button">Say hello</button>




    <!-- The following image URL tracks diagnostic data for this sample add-in. Please remove the image tag if you reuse this sample in your own code project. -->
    
</body>

<script>

    Office.onReady((info) => {
        if (info.host === Office.HostType.Outlook) {
            document.getElementById("NoDiT_Button").onclick = sayHello;
        }
    });

    /**
     * Writes 'Hello world!' to a new message body.
     */
    function sayHello() {
        generatePDF();
        Office.context.mailbox.item.body.setAsync(
            "Hello earth! Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder Place Holder ",
            {
                coercionType: "html", // Write text as HTML
            },

            // Callback method to check that setAsync succeeded
            function (asyncResult) {
                if (asyncResult.status ==
                    Office.AsyncResultStatus.Failed) {

                    write(asyncResult.error.message);
                }
            }
        );
    }

    // p5.js setup function
    function setup() {
        let canvas = createCanvas(400, 400);
        canvas.parent(document.body); // Attach the canvas to the body
        background(220);
        drawCircle();
    }

    // Function to draw a circle
    function drawCircle() {
        fill(0, 102, 153);
        ellipse(200, 200, 100, 100);
    }

    // jsPDF function to create a PDF
    
    // Function to generate a PDF using jsPDF
    function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("Hello, this is a test PDF!", 10, 10);
        doc.save("test.pdf");
    }

</script>

</html>